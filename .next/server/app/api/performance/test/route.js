(()=>{var e={};e.id=227,e.ids=[227],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},17546:()=>{},27599:(e,t,r)=>{"use strict";r.d(t,{$:()=>n,cn:()=>i});var s=r(46968),a=r(69333);function i(...e){return(0,a.QP)((0,s.$)(e))}function n(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69535:(e,t,r)=>{"use strict";r.d(t,{Y5:()=>o});class s{constructor(e=1e4){this.metrics=[],this.maxEntries=e}async store(e){if(this.metrics.push(e),this.metrics.length>this.maxEntries){let e=this.metrics.length-this.maxEntries;this.metrics.splice(0,e)}}async query(e){let t=this.metrics;return e.category&&(t=t.filter(t=>t.category===e.category)),e.startTime&&(t=t.filter(t=>t.timestamp>=e.startTime)),e.endTime&&(t=t.filter(t=>t.timestamp<=e.endTime)),e.tags&&(t=t.filter(t=>!!t.tags&&Object.entries(e.tags).every(([e,r])=>t.tags[e]===r))),t.sort((e,t)=>t.timestamp.getTime()-e.timestamp.getTime()),e.limit&&(t=t.slice(0,e.limit)),t}async getAggregated(e,t,r){let s=this.metrics.filter(r=>r.category===e&&r.timestamp>=t.start&&r.timestamp<=t.end);if(0===s.length)return[];let a=new Map;s.forEach(e=>{let t="all";if(r)switch(r){case"endpoint":t=e.endpoint||"unknown";break;case"eventType":t=e.eventType||"unknown";break;case"operation":t=e.operation||"unknown";break;case"component":t=e.component||"unknown";break;case"hour":t=e.timestamp.toISOString().slice(0,13)+":00:00";break;case"day":t=e.timestamp.toISOString().slice(0,10);break;default:t="all"}a.has(t)||a.set(t,[]),a.get(t).push(e)});let i=Array.from(a.entries()).map(([e,t])=>{let r=t.map(e=>e.value).sort((e,t)=>e-t),s=r.length,a=r.reduce((e,t)=>e+t,0),i=r[0],n=r[r.length-1],o=Math.floor(.95*s),c=Math.floor(.99*s),l=r[Math.min(o,s-1)],p=r[Math.min(c,s-1)];return{group:e,count:s,average:Math.round(a/s*100)/100,min:i,max:n,p95:l,p99:p}});return i.sort((e,t)=>e.group.localeCompare(t.group)),i}async cleanup(e){let t=this.metrics.length;return this.metrics=this.metrics.filter(t=>t.timestamp>e),t-this.metrics.length}getStorageStats(){let e,t;let r=this.metrics.length,s=JSON.stringify(this.metrics).length;if(r>0){let r=this.metrics.map(e=>e.timestamp).sort();e=r[0],t=r[r.length-1]}return{totalMetrics:r,memoryUsage:s,oldestMetric:e,newestMetric:t}}clear(){this.metrics=[]}}var a=r(27599);let i={enabled:!0,sampleRate:1,retentionDays:7,thresholds:{api:{responseTime:{warning:1e3,critical:3e3},errorRate:{warning:5,critical:10}},events:{processingTime:{warning:500,critical:2e3},queueSize:{warning:100,critical:500}},blockchain:{queryTime:{warning:2e3,critical:5e3},transactionTime:{warning:1e4,critical:3e4}}},alerting:{enabled:!0},storage:{type:"memory",maxMemoryEntries:1e4}};class n{constructor(e){this.alerts=[],this.alertCallbacks=[],this.config={...i,...e},this.storage=this.createStorage()}createStorage(){return this.config.storage.type,new s(this.config.storage.maxMemoryEntries||1e4)}shouldCollect(){return!!this.config.enabled&&Math.random()<this.config.sampleRate}async recordAPIMetric(e){if(!this.shouldCollect())return;let t={id:(0,a.$)(),name:`api_${e.method.toLowerCase()}_${e.endpoint.replace(/[^a-zA-Z0-9]/g,"_")}`,value:e.responseTime,unit:"ms",timestamp:new Date,category:"api",endpoint:e.endpoint,method:e.method,statusCode:e.statusCode,responseTime:e.responseTime,requestSize:e.requestSize,responseSize:e.responseSize,userAgent:e.userAgent,ip:e.ip,tags:e.tags};await this.storage.store(t),await this.checkAPIThresholds(t)}async recordEventMetric(e){if(!this.shouldCollect())return;let t={id:(0,a.$)(),name:`event_${e.eventType.toLowerCase().replace(/[^a-zA-Z0-9]/g,"_")}`,value:e.processingTime,unit:"ms",timestamp:new Date,category:"event",eventType:e.eventType,processingTime:e.processingTime,queueSize:e.queueSize,eventSource:e.eventSource,blockHeight:e.blockHeight,transactionId:e.transactionId,tags:e.tags};await this.storage.store(t),await this.checkEventThresholds(t)}async recordBlockchainMetric(e){if(!this.shouldCollect())return;let t={id:(0,a.$)(),name:`blockchain_${e.operation}_${e.network}`,value:e.responseTime,unit:"ms",timestamp:new Date,category:"blockchain",operation:e.operation,network:e.network,contractAddress:e.contractAddress,gasUsed:e.gasUsed,blockHeight:e.blockHeight,tags:{...e.tags,success:e.success.toString()}};await this.storage.store(t),await this.checkBlockchainThresholds(t)}async recordUIMetric(e){if(!this.shouldCollect())return;let t={id:(0,a.$)(),name:`ui_${e.component.toLowerCase().replace(/[^a-zA-Z0-9]/g,"_")}`,value:e.renderTime,unit:"ms",timestamp:new Date,category:"ui",component:e.component,renderTime:e.renderTime,interactionType:e.interactionType,route:e.route,tags:e.tags};await this.storage.store(t)}async checkAPIThresholds(e){let t=this.config.thresholds.api;if(e.responseTime>t.responseTime.critical?await this.createAlert({type:"critical",category:"api",message:`API response time critical: ${e.endpoint} took ${e.responseTime}ms`,metric:e,threshold:t.responseTime.critical}):e.responseTime>t.responseTime.warning&&await this.createAlert({type:"warning",category:"api",message:`API response time warning: ${e.endpoint} took ${e.responseTime}ms`,metric:e,threshold:t.responseTime.warning}),e.statusCode>=400){let r=await this.storage.query({category:"api",startTime:new Date(Date.now()-3e5),tags:{endpoint:e.endpoint}}),s=r.filter(e=>e.statusCode>=400).length,a=r.length,i=a>0?s/a*100:0;i>t.errorRate.critical?await this.createAlert({type:"critical",category:"api",message:`API error rate critical: ${e.endpoint} has ${i.toFixed(1)}% error rate`,metric:e,threshold:t.errorRate.critical}):i>t.errorRate.warning&&await this.createAlert({type:"warning",category:"api",message:`API error rate warning: ${e.endpoint} has ${i.toFixed(1)}% error rate`,metric:e,threshold:t.errorRate.warning})}}async checkEventThresholds(e){let t=this.config.thresholds.events;e.processingTime>t.processingTime.critical?await this.createAlert({type:"critical",category:"event",message:`Event processing time critical: ${e.eventType} took ${e.processingTime}ms`,metric:e,threshold:t.processingTime.critical}):e.processingTime>t.processingTime.warning&&await this.createAlert({type:"warning",category:"event",message:`Event processing time warning: ${e.eventType} took ${e.processingTime}ms`,metric:e,threshold:t.processingTime.warning}),e.queueSize>t.queueSize.critical?await this.createAlert({type:"critical",category:"event",message:`Event queue size critical: ${e.queueSize} events in queue`,metric:e,threshold:t.queueSize.critical}):e.queueSize>t.queueSize.warning&&await this.createAlert({type:"warning",category:"event",message:`Event queue size warning: ${e.queueSize} events in queue`,metric:e,threshold:t.queueSize.warning})}async checkBlockchainThresholds(e){let t=this.config.thresholds.blockchain["transaction"===e.operation?"transactionTime":"queryTime"];e.value>t.critical?await this.createAlert({type:"critical",category:"blockchain",message:`Blockchain ${e.operation} time critical: ${e.value}ms on ${e.network}`,metric:e,threshold:t.critical}):e.value>t.warning&&await this.createAlert({type:"warning",category:"blockchain",message:`Blockchain ${e.operation} time warning: ${e.value}ms on ${e.network}`,metric:e,threshold:t.warning})}async createAlert(e){let t={id:(0,a.$)(),type:e.type,category:e.category,message:e.message,metric:e.metric,threshold:e.threshold,timestamp:new Date,resolved:!1};this.alerts.push(t),this.alertCallbacks.forEach(e=>{try{e(t)}catch(e){console.error("[PerformanceCollector] Error in alert callback:",e)}}),console.warn(`[PerformanceCollector] ${e.type.toUpperCase()} ALERT: ${e.message}`)}onAlert(e){return this.alertCallbacks.push(e),()=>{let t=this.alertCallbacks.indexOf(e);t>-1&&this.alertCallbacks.splice(t,1)}}async getMetrics(e){return this.storage.query(e)}async getAggregatedMetrics(e,t,r){return this.storage.getAggregated(e,t,r)}getActiveAlerts(){return this.alerts.filter(e=>!e.resolved)}resolveAlert(e){let t=this.alerts.find(t=>t.id===e);t&&(t.resolved=!0,t.resolvedAt=new Date)}async cleanup(){let e=new Date(Date.now()-864e5*this.config.retentionDays),t=await this.storage.cleanup(e);console.log(`[PerformanceCollector] Cleaned up ${t} old metrics`);let r=new Date(Date.now()-2592e6),s=this.alerts.length;this.alerts=this.alerts.filter(e=>e.timestamp>r);let a=s-this.alerts.length;a>0&&console.log(`[PerformanceCollector] Cleaned up ${a} old alerts`)}updateConfig(e){this.config={...this.config,...e}}getConfig(){return{...this.config}}}let o=new n},75370:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>h,serverHooks:()=>d,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>u});var s={};r.r(s),r.d(s,{GET:()=>p,POST:()=>g});var a=r(45002),i=r(89587),n=r(1202),o=r(24715),c=r(95847),l=r(69535);let p=(0,c.mF)(async e=>{let t=new URL(e.url),r=parseInt(t.searchParams.get("delay")||"100"),s="true"===t.searchParams.get("error");try{let e=await (0,c.gT)("test_operation",async()=>{if(await new Promise(e=>setTimeout(e,r)),s)throw Error("Simulated error for testing");return{message:"Test operation completed",delay:r}},{test_param:r.toString(),error_simulation:s.toString()});return await l.Y5.recordEventMetric({eventType:"test_event",processingTime:r,queueSize:0,eventSource:"internal",tags:{test:"true",delay:r.toString()}}),o.NextResponse.json({success:!0,result:e,timestamp:new Date().toISOString()})}catch(e){return o.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Unknown error",timestamp:new Date().toISOString()},{status:500})}}),g=(0,c.mF)(async e=>{try{let t=await e.json();return await l.Y5.recordBlockchainMetric({operation:"query",network:"testnet",responseTime:1e3*Math.random()+500,success:!0,tags:{test:"true",contract:"TestContract"}}),o.NextResponse.json({success:!0,message:"Test blockchain metric recorded",body:t})}catch(e){return o.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}),h=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/performance/test/route",pathname:"/api/performance/test",filename:"route",bundlePath:"app/api/performance/test/route"},resolvedPagePath:"/home/altcoin-daddy/Downloads/ownly/app/api/performance/test/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:u,serverHooks:d}=h;function w(){return(0,n.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:u})}},80594:()=>{},95847:(e,t,r)=>{"use strict";r.d(t,{fR:()=>n,gT:()=>i,mF:()=>a});var s=r(69535);function a(e){return async function(t,...r){let a,i;let n=performance.now(),o=new URL(t.url).pathname,c=t.method,l=t.headers.get("content-length")?parseInt(t.headers.get("content-length")):void 0,p=200;try{p=(a=await e(t,...r)).status;let s=a.headers.get("content-length");return s&&(i=parseInt(s)),a}catch(e){throw p=500,e}finally{let e=performance.now()-n;await s.Y5.recordAPIMetric({endpoint:o,method:c,statusCode:p,responseTime:e,requestSize:l,responseSize:i,userAgent:t.headers.get("user-agent")||void 0,ip:t.headers.get("x-forwarded-for")||t.headers.get("x-real-ip")||"unknown",tags:{route:o,status_class:`${Math.floor(p/100)}xx`}})}}}async function i(e,t,r){let a=performance.now();try{let i=await t(),n=performance.now()-a;return await s.Y5.recordAPIMetric({endpoint:`/internal/${e}`,method:"POST",statusCode:200,responseTime:n,tags:{operation:e,...r}}),i}catch(i){let t=performance.now()-a;throw await s.Y5.recordAPIMetric({endpoint:`/internal/${e}`,method:"POST",statusCode:500,responseTime:t,tags:{operation:e,error:i instanceof Error?i.message:"unknown",...r}}),i}}async function n(e,t,r,a){let i=performance.now();try{let n=await a(),o=performance.now()-i;return await s.Y5.recordAPIMetric({endpoint:`${e}${t}`,method:r,statusCode:200,responseTime:o,tags:{external_api:e,api_type:"external"}}),n}catch(o){let a=performance.now()-i,n=500;throw o&&"object"==typeof o&&"status"in o&&(n=o.status||500),await s.Y5.recordAPIMetric({endpoint:`${e}${t}`,method:r,statusCode:n,responseTime:a,tags:{external_api:e,api_type:"external",error:o instanceof Error?o.message:"unknown"}}),o}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[555,912,700],()=>r(75370));module.exports=s})();