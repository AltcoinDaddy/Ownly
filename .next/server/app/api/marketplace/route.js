"use strict";(()=>{var e={};e.id=711,e.ids=[711],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27711:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>m,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{GET:()=>p});var s=r(45002),i=r(89587),n=r(1202),c=r(24715),o=r(30626),l=r(50138);async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("cursor")||void 0,a=t.get("limit")?parseInt(t.get("limit")):void 0,s=t.get("category")||void 0,i=t.get("minPrice")?parseFloat(t.get("minPrice")):void 0,n=t.get("maxPrice")?parseFloat(t.get("maxPrice")):void 0,o=t.get("sortBy")||"created_at",p=t.get("sortOrder")||"desc",d="false"!==t.get("cache"),u=await l.v.getMarketplaceListings({cursor:r,limit:a,category:s,minPrice:i,maxPrice:n,sortBy:o,sortOrder:p},d),h=c.NextResponse.json(u);return h.headers.set("Cache-Control","public, s-maxage=60, stale-while-revalidate=300"),h}catch(e){if(console.error("Marketplace data fetch error:",e),e instanceof o.z)return c.NextResponse.json({error:e.message,type:e.type,details:e.details},{status:e.statusCode||500});return c.NextResponse.json({error:"Internal server error"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/marketplace/route",pathname:"/api/marketplace",filename:"route",bundlePath:"app/api/marketplace/route"},resolvedPagePath:"/home/altcoin-daddy/Downloads/ownly/app/api/marketplace/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:u,workUnitAsyncStorage:h,serverHooks:g}=d;function m(){return(0,n.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:h})}},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},50138:(e,t,r)=>{r.d(t,{v:()=>i});var a=r(52268);class s{generateCacheKey(e){if(!e)return"default";let t=new URLSearchParams;return e.cursor&&t.append("cursor",e.cursor),e.limit&&t.append("limit",e.limit.toString()),e.category&&t.append("category",e.category),e.minPrice&&t.append("minPrice",e.minPrice.toString()),e.maxPrice&&t.append("maxPrice",e.maxPrice.toString()),e.sortBy&&t.append("sortBy",e.sortBy),e.sortOrder&&t.append("sortOrder",e.sortOrder),t.toString()||"default"}async getMarketplaceListings(e,t=!0){let r=this.generateCacheKey(e);if(t){let e=this.getFromCache(r);if(e)return e.data}try{let t=await a.K.getMarketplaceListings(e);return this.setCache(r,t),t}catch(t){console.error("Error fetching marketplace listings:",t);let e=this.cache.get(r);if(e)return e.data;throw t}}getFromCache(e){let t=this.cache.get(e);return t?Date.now()>t.expires_at?(this.cache.delete(e),null):t:null}setCache(e,t){if(this.cache.size>=this.MAX_CACHE_SIZE){let e=this.cache.keys().next().value;e&&this.cache.delete(e)}let r={key:e,data:t,cached_at:Date.now(),expires_at:Date.now()+this.CACHE_TTL};this.cache.set(e,r)}clearCache(e){e?this.cache.delete(e):this.cache.clear()}getCacheStats(){return{size:this.cache.size,maxSize:this.MAX_CACHE_SIZE,ttl:this.CACHE_TTL}}invalidateCache(){this.cache.clear()}constructor(){this.cache=new Map,this.CACHE_TTL=12e4,this.MAX_CACHE_SIZE=50}}let i=new s},52268:(e,t,r)=>{r.d(t,{K:()=>n,S:()=>i});var a=r(76036),s=r(18393);class i{async mintOwnlyNFT(e,t){let r={metadata_url:e,recipient:t,collection_id:s.Wr};return a.Y.mintNFT(r)}async transferNFT(e,t,r){return a.Y.transferNFT({nft_id:e,from:t,to:r})}async listNFTForSale(e,t,r){return a.Y.listNFT({nft_id:e,price:t,currency:"FLOW",seller:r})}async buyNFT(e,t){return a.Y.buyNFT({nft_id:e,buyer:t})}async getUserCollection(e){return a.Y.getUserNFTs(e)}async getRecentEvents(e){return a.Y.getEvents(e)}async getMarketplaceListings(e){let t=new URLSearchParams;return e?.cursor&&t.append("cursor",e.cursor),e?.limit&&t.append("limit",e.limit.toString()),e?.category&&t.append("category",e.category),e?.minPrice&&t.append("min_price",e.minPrice.toString()),e?.maxPrice&&t.append("max_price",e.maxPrice.toString()),e?.sortBy&&t.append("sort_by",e.sortBy),e?.sortOrder&&t.append("sort_order",e.sortOrder),a.Y.getMarketplaceListings(t.toString())}static isValidFlowAddress(e){return/^0x[a-fA-F0-9]{16}$/.test(e)}static formatFlowAddress(e){return e?e.startsWith("0x")?e:`0x${e}`:""}}let n=new i},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[555,912,700,540],()=>r(27711));module.exports=a})();